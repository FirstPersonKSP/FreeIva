Modified from https://github.com/karl-/pb_CSG